# LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling
# 大语言模型辅助的动态柔性装配流水车间调度自动派工规则设计

**Authors**: Junhao Qiu, Haoyang Zhuang, Fei Liu, Jianjun Liu, Qingfu Zhang \
**Date**: 2026-01-22 \
**PDF**: https://arxiv.org/pdf/2601.15738v1 \
**Tags**: <span class="tag-label tag-blue">精读区</span> <span class="tag-label tag-green">EOH</span> <span class="tag-label tag-green">EAA</span> \
**Score**: 9.0 \
**Evidence**: 大模型辅助的调度启发式算法自动设计 \
**TLDR**: 开发了一种大模型辅助方法，用于在动态调度环境中自动设计派发规则。 \

---

## Abstract
Dynamic multi-product delivery environments demand rapid coordination of part completion and product-level kitting within hybrid processing and assembly systems to satisfy strict hierarchical supply constraints. The flexible assembly flow shop scheduling problem formally defines dependencies for multi-stage kitting, yet dynamic variants make designing integrated scheduling rules under multi-level time coupling highly challenging. Existing automated heuristic design methods, particularly genetic programming constrained to fixed terminal symbol sets, struggle to capture and leverage dynamic uncertainties and hierarchical dependency information under transient decision states. This study develops an LLM-assisted Dynamic Rule Design framework (LLM4DRD) that automatically evolves integrated online scheduling rules adapted to scheduling features. Firstly, multi-stage processing and assembly supply decisions are transformed into feasible directed edge orderings based on heterogeneous graph. Then, an elite knowledge guided initialization embeds advanced design expertise into initial rules to enhance initial quality. Additionally, a dual-expert mechanism is introduced in which LLM-A evolutionary code to generate candidate rules and LLM-S conducts scheduling evaluation, while dynamic feature-fitting rule evolution combined with hybrid evaluation enables continuous improvement and extracts adaptive rules with strong generalization capability. A series of experiments are conducted to validate the effectiveness of the method. The average tardiness of LLM4DRD is 3.17-12.39% higher than state-of-the-art methods in 20 practical instances used for training and testing, respectively. In 24 scenarios with different resource configurations, order loads, and disturbance levels totaling 480 instances, it achieves 11.10% higher performance than the second best competitor, exhibiting excellent robustness.

## 摘要
动态多产品交付

---

## 论文详细总结（自动生成）

这是一份关于论文《LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling》的结构化深入总结：

### 1. 核心问题与整体含义（研究动机和背景）
*   **核心问题**：如何在具有**动态订单到达**和**双重配套约束**（零件加工配套+产品装配配套）的柔性装配流水车间（FAFSP）中，自动设计高效的在线调度规则（派工规则，PDRs）。
*   **研究背景**：
    *   **制造模式转变**：从大规模生产转向小批量定制，要求系统具备极高的响应速度。
    *   **复杂约束**：多产品交付要求不同零件在时间维度上高度协同，任何一个零件的延迟都会导致整个订单交付失败。
    *   **传统方法局限**：传统的遗传编程（GP）依赖预定义的终端符号集，难以捕捉动态不确定性；而深度强化学习（DRL）则高度依赖预设规则集的质量。
*   **整体含义**：利用大语言模型（LLM）的逻辑推理与代码生成能力，构建一个能够自动演化、具备语义感知能力且能处理复杂层级约束的调度规则设计框架。

### 2. 方法论：核心思想与关键技术
论文提出了 **LLM4DRD** 框架，其核心流程如下：
*   **异构图建模**：将多阶段加工与装配决策建模为基于异构图的马尔可夫决策过程（MDP），通过有向边的排序消除层级供应冲突。
*   **精英知识引导初始化**：不从零开始随机生成，而是提取经典规则（如EDD）的逻辑作为“精英知识”，引导LLM生成高质量的初始规则种群。
*   **双专家协作机制**：
    *   **LLM-A（算法专家）**：负责编写和修改调度规则的Python代码。
    *   **LLM-S（调度专家）**：负责分析规则在模拟环境中的表现，提供定性的改进建议（如“应加强对瓶颈机器的关注”）。
*   **混合评估策略**：结合**定量指标**（平均延期时间）与**定性反馈**（LLM-S的语义分析），为规则演化提供多维度的导航。
*   **特征拟合演化**：设计了包含订单、机器、弧（Arc）三个维度的动态特征向量，使生成的规则能根据系统实时状态（如利用率、到期时间、剩余工序）自适应调整优先级。

### 3. 实验设计
*   **数据集与场景**：
    *   **工业实例**：基于中国某家电制造商的真实订单结构和资源配置数据。
    *   **合成实例**：通过调整机器数量、柔性因子、订单到达频率（泊松过程）生成多样化场景。
*   **Benchmark（基准）**：
    *   **传统自动设计方法**：遗传编程（GP）、基因表达式编程（GEP）。
    *   **LLM辅助设计方法**：EOH、FunSearch、ReEvo、MCTS-AHD等。
    *   **经典启发式规则**：EDD、FIFO+SPT、MOPNR+EET等9种组合规则。
*   **对比维度**：收敛速度、平均延期时间（Tardiness）、代码准确率、跨场景鲁棒性。

### 4. 资源与算力
*   **硬件环境**：实验运行在 Intel Core i5-12600KF 处理器上。
*   **模型使用**：调用了多种商业/开源模型 API，包括 **GPT-4o-mini**（主选）、Qwen-2-72B、Claude-3.5-Sonnet、DeepSeek-Chat。
*   **算力消耗**：文中未明确给出总训练时长，但记录了 Token 消耗量（如 GPT-4o-mini 在单次任务中消耗约 0.33M Tokens，成本约 0.09 美元）。由于是基于代码生成的启发式搜索，其算力需求远低于深度强化学习的训练。

### 5. 实验数量与充分性
*   **实验规模**：
    *   **训练与基础测试**：在20个具有代表性的工业实例上进行。
    *   **鲁棒性测试**：构建了24种不同配置的场景，共计 **480个测试实例**。
    *   **消融实验**：针对动态特征、精英初始化、双专家机制等5个核心模块进行了独立验证。
*   **充分性评价**：实验设计非常充分。不仅对比了同类LLM方法，还跨越了传统进化算法和人工规则；覆盖了从参数敏感性分析到长周期演化收敛性的全过程，结果具有较高的客观性和说服力。

### 6. 主要结论与发现
*   **性能卓越**：LLM4DRD 生成的规则在平均延期时间上比 SOTA 方法（如 EOH, GP）提升了 **3.17% - 12.39%**。
*   **强鲁棒性**：在极端高负载和频繁扰动的场景下，LLM4DRD 的表现优于次优竞争对手 **11.10%**，证明其能有效应对动态不确定性。
*   **语义引导有效性**：消融实验证明，LLM-S 提供的定性建议能帮助算法跳出局部最优，实现“二次收敛”。
*   **特征拟合**：动态特征的引入对性能提升贡献最大，证明了实时状态感知在复杂调度中的核心地位。

### 7. 优点（亮点）
*   **知识闭环**：成功将人类专家的调度经验（精英知识）与 LLM 的自主探索相结合，解决了 LLM 盲目搜索的问题。
*   **可解释性**：生成的规则以 Python 代码形式存在，相比 DRL 的“黑盒”策略，更易于工业界理解和部署。
*   **处理复杂约束**：通过异构图和特征工程，巧妙解决了 FAFSP 中棘手的多级配套（Kitting）冲突。

### 8. 不足与局限
*   **API 依赖**：框架高度依赖商业 LLM 的 API 性能，模型版本的更新或网络波动可能影响结果稳定性。
*   **成本考量**：虽然单次演化成本较低，但在大规模种群或超长迭代下，Token 消耗仍是一笔开支。
*   **扰动类型有限**：目前主要考虑订单动态到达，尚未深入探讨机器故障（Breakdowns）或运输资源受限等更复杂的并发扰动。
*   **实时性限制**：虽然规则执行是毫秒级的，但规则的“在线演化”过程（重新设计规则）仍需分钟级时间，无法做到秒级的规则重构。

（完）
