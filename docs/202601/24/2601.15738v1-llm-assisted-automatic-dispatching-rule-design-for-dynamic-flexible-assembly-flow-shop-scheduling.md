# LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling
# 大语言模型辅助的动态柔性装配流水车间调度自动调度规则设计

**Authors**: Junhao Qiu, Haoyang Zhuang, Fei Liu, Jianjun Liu, Qingfu Zhang \
**Date**: 2026-01-22 \
**PDF**: https://arxiv.org/pdf/2601.15738v1 \
**Tags**: <span class="tag-label tag-blue">精读区</span> <span class="tag-label tag-green">EOH</span> <span class="tag-label tag-green">EAA</span> \
**Score**: 9.0 \
**Evidence**: 大模型辅助的调度启发式算法自动设计 \
**TLDR**: 利用大语言模型自动设计动态柔性装配流水线调度的派工规则。

---

## 速览
**TLDR**：提出一种基于大语言模型（LLM）的自动调度规则设计框架 LLM4DRD，用于解决动态柔性装配流水车间调度问题。
**Motivation**：传统的启发式设计方法难以捕捉动态不确定性和多级层级依赖信息，导致在复杂调度环境下性能受限。
**Method**：结合异构图建模与双专家机制，利用 LLM 进行代码进化与调度评估，并通过精英知识引导实现规则的自动演化。
**Result**：在多项实验中，该方法的平均延迟指标比现有最先进方法提升了 3.17%-12.39%，且在 480 个测试场景中展现出卓越的鲁棒性。
**Conclusion**：LLM 辅助的规则设计能有效提取强泛化性的调度规则，为处理具有复杂约束的动态制造系统提供了高效的新途径。

---

## Abstract
Dynamic multi-product delivery environments demand rapid coordination of part completion and product-level kitting within hybrid processing and assembly systems to satisfy strict hierarchical supply constraints. The flexible assembly flow shop scheduling problem formally defines dependencies for multi-stage kitting, yet dynamic variants make designing integrated scheduling rules under multi-level time coupling highly challenging. Existing automated heuristic design methods, particularly genetic programming constrained to fixed terminal symbol sets, struggle to capture and leverage dynamic uncertainties and hierarchical dependency information under transient decision states. This study develops an LLM-assisted Dynamic Rule Design framework (LLM4DRD) that automatically evolves integrated online scheduling rules adapted to scheduling features. Firstly, multi-stage processing and assembly supply decisions are transformed into feasible directed edge orderings based on heterogeneous graph. Then, an elite knowledge guided initialization embeds advanced design expertise into initial rules to enhance initial quality. Additionally, a dual-expert mechanism is introduced in which LLM-A evolutionary code to generate candidate rules and LLM-S conducts scheduling evaluation, while dynamic feature-fitting rule evolution combined with hybrid evaluation enables continuous improvement and extracts adaptive rules with strong generalization capability. A series of experiments are conducted to validate the effectiveness of the method. The average tardiness of LLM4DRD is 3.17-12.39% higher than state-of-the-art methods in 20 practical instances used for training and testing, respectively. In 24 scenarios with different resource configurations, order loads, and disturbance levels totaling 480 instances, it achieves 11.10% higher performance than the second best competitor, exhibiting excellent robustness.

## 摘要
动态多产品交付环境要求在混合加工与装配系统中快速协调零件完工和产品级配套，以满足严格的分层供应约束。柔性装配流水车间调度问题正式定义了多阶段配套的依赖关系，但其动态变体使得在多级时间耦合下设计集成调度规则极具挑战性。现有的自动启发式设计方法，特别是受限于固定终结符集的遗传编程，难以捕捉和利用瞬态决策状态下的动态不确定性和分层依赖信息。本研究开发了一个大语言模型辅助的动态规则设计框架（LLM4DRD），该框架能够自动演化出适应调度特征的集成在线调度规则。首先，基于异构图将多阶段加工和装配供应决策转化为可行的有向边排序。然后，通过精英知识引导的初始化将先进的设计专业知识嵌入初始规则中，以提高初始质量。此外，引入了双专家机制，其中 LLM-A 演化代码以生成候选规则，LLM-S 进行调度评估，而动态特征拟合规则演化结合混合评估实现了持续改进，并提取出具有强泛化能力的自适应规则。一系列实验验证了该方法的有效性。在用于训练和测试的 20 个实际实例中，LLM4DRD 的平均延迟性能比最先进的方法高出 3.17-12.39%。在包含不同资源配置、订单负载和扰动水平的 24 个场景（共 480 个实例）中，其性能比次优竞争对手高出 11.10%，展现出卓越的鲁棒性。

---

## 论文详细总结（自动生成）

这篇论文介绍了一种利用大语言模型（LLM）自动设计调度规则的新框架，旨在解决复杂的动态柔性装配流水车间调度问题。以下是对该论文的深度结构化总结：

### 1. 研究动机与核心问题
*   **研究背景**：在个性化定制生产环境下，制造系统面临多产品配套交付（Kitting Delivery）的严峻挑战。订单的交付时间取决于其中最晚完成的产品，这产生了强烈的层级耦合约束。
*   **核心问题**：动态柔性装配流水车间调度（FAFSP）涉及加工、装配、交付多个阶段。传统的派工规则（PDR）是静态的，难以应对订单随机到达等动态扰动；而基于遗传编程（GP）的自动设计方法受限于固定的符号集，缺乏对复杂系统语义的理解。
*   **研究目标**：开发一个能自动演化、具备语义感知能力且能处理多级约束的在线调度规则设计框架。

### 2. 方法论：LLM4DRD 框架
核心思想是将 LLM 作为“启发式算法设计者”，通过双专家协作机制实现规则的迭代进化。
*   **异构图建模**：将加工和装配决策统一建模为异构图上的有向边选择问题，将调度过程转化为马尔可夫决策过程（MDP），并设计了涵盖订单、加工弧、资源三个维度的 9 类动态特征。
*   **双专家机制（Dual-Expert）**：
    *   **算法专家 (LLM-A)**：负责代码生成，根据提示词（Prompt）编写 Python 格式的派工规则函数。
    *   **调度专家 (LLM-S)**：负责语义评估，分析规则在仿真环境中的表现，指出优缺点并提供改进建议（如“加强对紧迫期限任务的关注”）。
*   **精英知识引导初始化**：不从零开始，而是将经典规则（如 EDD）的逻辑作为初始提示词，引导 LLM 在高起点上进行探索。
*   **特征拟合规则演化**：设计了四种提示词策略：
    *   **C1/C2（交叉）**：优势融合交叉与探索性交叉。
    *   **M1/M2（变异）**：定向逻辑优化与参数微调。
*   **混合评估**：结合定量指标（平均延迟）与定性分析（专家反馈），确保规则既有高性能又有逻辑合理性。

### 3. 实验设计
*   **数据集来源**：基于中国某家电制造企业的真实订单结构和资源配置数据，结合泊松分布模拟动态订单到达。
*   **对比方法（Benchmarks）**：
    *   **传统 AHD 方法**：遗传编程（GP）、基因表达式编程（GEP）。
    *   **前沿 LLM 方法**：FunSearch、EOH、MCTS-AHD、ReEvo、随机采样。
    *   **经典启发式规则**：EDD 以及 FIFO、SPT、EET 等 9 种组合规则。
*   **实验场景**：涵盖 20 个核心训练/测试实例，以及 24 种不同资源配置、负载强度和扰动水平的鲁棒性测试场景。

### 4. 资源与算力
*   **硬件环境**：实验在 Intel Core i5-12600KF 处理器上运行。
*   **模型使用**：主要使用 **GPT-4o-mini** 作为底层 LLM（经过对 Qwen、Claude、DeepSeek 等模型的对比测试，认为其性价比和代码准确率最高）。
*   **算力说明**：论文未提及具体的 GPU 训练时长，因为 LLM 是通过 API 调用的。规则的演化过程是离线的，而生成的规则在在线应用时仅需毫秒级响应。

### 5. 实验数量与充分性
*   **实验规模**：总计进行了 **480 个实例** 的测试（24 个场景 × 20 个重复实验）。
*   **充分性评价**：实验设计非常充分。不仅对比了同类 LLM 框架，还进行了详细的**消融实验**（验证了动态特征、精英初始化、双专家机制等模块的贡献），并分析了算法的收敛过程和代码演化逻辑，体现了高度的客观性与公平性。

### 6. 主要结论与发现
*   **性能卓越**：LLM4DRD 生成的规则在平均延迟指标上比现有最先进方法（如 EOH、GP）提升了 **3.17% - 12.39%**。
*   **鲁棒性强**：在极端高负载和频繁扰动场景下，LLM4DRD 比次优竞争对手性能高出 **11.10%**，且波动更小。
*   **语义优势**：实验证明，LLM-S 提供的定性建议能帮助算法跳出局部最优，实现“二次收敛”。
*   **泛化能力**：在未见过的测试实例上，LLM 生成的规则表现稳定，证明其捕捉到了问题的结构化特征而非简单的过拟合。

### 7. 优点与亮点
*   **可解释性**：生成的规则是可读的 Python 代码，相比神经网络黑盒，更易于工业界理解和部署。
*   **知识融合**：成功将人类专家的调度经验（精英知识）与 LLM 的逻辑推理能力结合。
*   **端到端自动化**：实现了从问题描述到可执行代码的闭环自动演化，极大降低了启发式算法的设计门槛。

### 8. 不足与局限
*   **API 依赖与成本**：依赖商业 LLM 接口，在大规模迭代时可能产生较高的 Token 费用。
*   **约束覆盖**：虽然考虑了配套约束，但尚未涵盖更复杂的二次资源（如模具、人力）或运输约束。
*   **提示词敏感性**：尽管设计了多种策略，但 LLM 的输出仍具有随机性，对提示词的微小变动可能敏感。

（完）
