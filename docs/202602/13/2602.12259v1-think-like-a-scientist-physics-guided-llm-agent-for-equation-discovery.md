---
title: "Think like a Scientist: Physics-guided LLM Agent for Equation Discovery"
authors: "Jianke Yang, Ohm Venkatachalam, Mohammad Kianezhad, Sharvaree Vadgama, Rose Yu"
date: 2026-02-12
pdf: "https://arxiv.org/pdf/2602.12259v1"
tags: ["keyword:SR", "query:SR"]
score: 10.0
evidence: 符号方程发现与科学推理
tldr: 本研究针对科学发现中的符号方程提取问题，提出了 KeplerAgent 框架。不同于以往直接从数据猜测方程的 LLM 方法，该框架模拟科学家的多步推理过程：先利用物理工具推断对称性等中间结构，再以此为先验配置 PySINDy 和 PySR 等符号回归引擎。实验表明，KeplerAgent 在多个物理方程基准测试中展现出极高的符号准确率和抗噪鲁棒性，为物理引导的 LLM 智能体研究提供了新思路。
motivation: 现有 LLM 系统往往直接从数据中盲目猜测方程，缺乏科学家先推导物理属性、再限制搜索空间的系统性推理过程。
method: 提出 KeplerAgent 框架，通过 LLM 协调物理工具提取结构先验，并动态配置符号回归引擎的函数库与约束条件。
result: 在物理方程基准测试中，该方法在符号准确性和对噪声数据的鲁棒性方面均大幅超越了传统符号回归和现有 LLM 基准。
conclusion: 将物理先验推理与符号回归引擎相结合的智能体架构，是实现高效且准确的科学方程发现的有效途径。
---

## Abstract
Explaining observed phenomena through symbolic, interpretable formulas is a fundamental goal of science. Recently, large language models (LLMs) have emerged as promising tools for symbolic equation discovery, owing to their broad domain knowledge and strong reasoning capabilities. However, most existing LLM-based systems try to guess equations directly from data, without modeling the multi-step reasoning process that scientists often follow: first inferring physical properties such as symmetries, then using these as priors to restrict the space of candidate equations. We introduce KeplerAgent, an agentic framework that explicitly follows this scientific reasoning process. The agent coordinates physics-based tools to extract intermediate structure and uses these results to configure symbolic regression engines such as PySINDy and PySR, including their function libraries and structural constraints. Across a suite of physical equation benchmarks, KeplerAgent achieves substantially higher symbolic accuracy and greater robustness to noisy data than both LLM and traditional baselines.

---

## 论文详细总结（自动生成）

这是一份关于论文《Think like a Scientist: Physics-guided LLM Agent for Equation Discovery》的结构化深入总结：

### 1. 核心问题与整体含义（研究动机和背景）
论文的核心问题是如何提高**符号方程发现（Equation Discovery）**的准确性和效率。
*   **背景**：从观测数据中推导简洁、可解释的数学公式是科学发现的核心。传统的符号回归（SR）工具（如 PySR）依赖专家手动配置复杂的搜索空间；而现有的 LLM 方法（如 LLM-SR）通常采用“暴力破解”模式，直接从数据猜测方程。
*   **动机**：人类科学家在发现方程时，通常遵循多步推理：先通过实验观察推断物理属性（如对称性、守恒律），再利用这些先验知识缩小候选方程的搜索范围。本论文旨在构建一个模拟这种“科学家思维”的智能体框架。

### 2. 方法论：KeplerAgent 框架
KeplerAgent 是一个基于 **ReAct 模式**的物理引导 LLM 智能体，其核心思想是**工具编排与多步推理**。
*   **核心流程**：
    1.  **探索性分析**：调用 Python 解释器计算统计量，或调用视觉子智能体分析数据图表（识别周期性、增长趋势等）。
    2.  **物理结构发现**：使用专门的算法工具识别**李对称性（Lie Symmetry）**。该工具训练一个小型神经网络作为代理模型，通过优化无穷小生成器矩阵来提取对称性。
    3.  **动态配置 SR 后端**：LLM 将发现的物理结构（如旋转对称性）转化为 **PySINDy** 或 **PySR** 的具体配置参数（如约束算子、函数库、方程模板）。
    4.  **迭代优化**：根据回归结果（如 MAPE 误差）和经验日志，智能体决定是终止搜索还是调整策略重新调用工具。

### 3. 实验设计
*   **数据集/场景**：
    *   **LSR-Transform**：来自 LLM-SRBench，包含 111 个经过坐标变换的物理方程（防止 LLM 仅靠记忆答题）。
    *   **DiffEq Benchmark**：作者自定义的 10 个常微分方程（ODE）和偏微分方程（PDE）系统（如捕食者-猎物模型、反应扩散方程），包含干净数据和噪声数据。
*   **对比方法**：
    *   **PySR**：传统的基于遗传算法的符号回归工具。
    *   **LLM-SR**：目前最先进的基于 LLM 的符号回归方法。
*   **评价指标**：符号准确率（SA）、归一化均方误差（NMSE）以及长时预测的数值稳定性。

### 4. 资源与算力
*   **模型**：主要使用 **GPT-4o-mini** 作为智能体的大脑。
*   **算力说明**：论文未详细列出具体的 GPU 型号和训练时长。由于该框架是基于推理的智能体（Agentic Framework），不涉及大规模模型预训练，其算力消耗主要集中在 LLM API 调用和本地运行的轻量级 SR 工具（如 PySINDy 的稀疏回归通常在 CPU 上即可快速完成）。

### 5. 实验数量与充分性
*   **实验规模**：涵盖了 111 个代数方程和 20 个微分方程（10 个系统各 2 个方程），并针对微分方程进行了干净和噪声（1% 噪声水平）两种情况的测试。
*   **充分性**：实验设计较为全面，不仅对比了符号恢复的准确性，还通过数值模拟验证了发现方程的物理有效性。引入噪声实验证明了该方法在现实科学场景中的鲁棒性。对比基准选择了该领域最新的 SOTA 方法，具有客观性。

### 6. 主要结论与发现
*   **性能领先**：KeplerAgent 在符号准确率上显著优于 LLM-SR 和纯 PySR。在 DiffEq 噪声数据集上，其符号准确率是基准方法的 3 倍以上。
*   **效率提升**：相比于 LLM-SR 需要数千次采样，KeplerAgent 通过精准的工具调用，在更短的时间内、消耗更少的 Token 即可达成目标。
*   **物理引导的价值**：实验证明，先推断对称性再进行受限搜索，能极大地缩小假设空间，使智能体能够处理复杂的耦合微分方程系统。

### 7. 优点与亮点
*   **模拟科学工作流**：改变了 LLM 盲目猜测的现状，将“物理属性推断”作为 SR 的前置步骤，更符合科学发现的逻辑。
*   **工具集成能力**：成功将数值算法（对称性发现）、视觉分析（图表理解）与符号搜索工具无缝整合。
*   **鲁棒性强**：在处理带有噪声的复杂动力系统（如反应扩散 PDE）时表现出色，这是传统方法和纯 LLM 方法的痛点。

### 8. 不足与局限
*   **工具集规模有限**：目前仅集成了对称性发现等少数物理工具，尚未涵盖量纲分析、分叉结构分析等更多物理先验。
*   **上下文窗口压力**：随着工具说明和经验日志的增加，LLM 的上下文负担加重，可能导致长序列下的推理失效。
*   **迭代冗余**：在某些噪声环境下，智能体可能会陷入重复调用相同参数工具的死循环（尽管有最大步数限制）。
*   **依赖底层工具**：如果对称性发现工具失效，智能体可能会被错误的中间结论误导。

（完）
