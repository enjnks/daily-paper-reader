---
title: Variational Grey-Box Dynamics Matching
title_zh: 变分灰盒动力学匹配
authors: "Gurjeet Sangra Singh, Frantzeska Lavda, Giangiacomo Mercatali, Alexandros Kalousis"
date: 2026-02-19
pdf: "https://arxiv.org/pdf/2602.17477v1"
tags: ["keyword:SR", "query:SR"]
score: 6.0
evidence: 物理系统的灰盒动力学匹配
tldr: 本文提出了一种变分灰盒动力学匹配方法（VGB-DM），旨在弥合黑盒生成模型与不完整物理模型之间的差距。该方法将物理方程集成到流匹配框架中，通过引入两个潜在变量分别建模缺失的随机性和物理参数，实现了无需数值模拟的动力学学习。实验证明，该方法在保持物理可解释性的同时，在多项ODE/PDE任务中表现优于或持平于现有基准。
motivation: 为了解决深度生成模型缺乏物理可解释性以及传统物理模型因项缺失而无法完全描述现实观测的问题。
method: 在流匹配框架中构建结构化变分分布，利用潜在编码处理物理参数和未知随机性，并扩展至二阶动力学建模。
result: 在多种ODE和PDE实验中，该方法在预测精度和参数推断上均达到或超过了纯数据驱动及现有的灰盒模型。
conclusion: VGB-DM成功实现了物理先验与生成模型的深度融合，提供了一种高效、可解释且无需模拟的动力学学习新方案。
---

## 摘要
深度生成模型（如流匹配和扩散模型）在学习复杂分布和动力系统方面展现出巨大潜力，但通常作为黑盒运行，忽略了底层的物理规律。相比之下，由常微分方程（ODE）/偏微分方程（PDE）描述的基于物理的模拟模型保持了可解释性，但可能存在缺失或未知的项，无法完全描述现实世界的观测结果。我们通过一种新颖的灰盒方法弥合了这一差距，该方法将不完整的物理模型直接集成到生成模型中。我们的方法仅从观测轨迹中学习动力学，无需真实的物理参数，并以一种免模拟（simulation-free）的方式避免了神经常微分方程（Neural ODEs）的可扩展性和稳定性问题。我们方法的核心在于在流匹配框架内建模一个结构化变分分布，通过使用两个隐编码：一个用于建模缺失的随机性和多模态速度，另一个将物理参数编码为具有物理启发先验（physics-informed prior）的隐变量。此外，我们还展示了该框架在处理二阶动力学方面的改进。我们在代表性 ODE/PDE 问题上的实验表明，我们的方法在保持物理模型可解释性的同时，性能与完全数据驱动的方法及之前的灰盒基准模型相当或更优。我们的代码可在 https://github.com/DMML-Geneva/VGB-DM 获取。

## Abstract
Deep generative models such as flow matching and diffusion models have shown great potential in learning complex distributions and dynamical systems, but often act as black-boxes, neglecting underlying physics. In contrast, physics-based simulation models described by ODEs/PDEs remain interpretable, but may have missing or unknown terms, unable to fully describe real-world observations. We bridge this gap with a novel grey-box method that integrates incomplete physics models directly into generative models. Our approach learns dynamics from observational trajectories alone, without ground-truth physics parameters, in a simulation-free manner that avoids scalability and stability issues of Neural ODEs. The core of our method lies in modelling a structured variational distribution within the flow matching framework, by using two latent encodings: one to model the missing stochasticity and multi-modal velocity, and a second to encode physics parameters as a latent variable with a physics-informed prior. Furthermore, we present an adaptation of the framework to handle second-order dynamics. Our experiments on representative ODE/PDE problems show that our method performs on par with or superior to fully data-driven approaches and previous grey-box baselines, while preserving the interpretability of the physics model. Our code is available at https://github.com/DMML-Geneva/VGB-DM.