---
title: "Prior-Guided Symbolic Regression: Towards Scientific Consistency in Equation Discovery"
title_zh: 先验引导的符号回归：迈向方程发现中的科学一致性
authors: "Jing Xiao, Xinhai Chen, Jiaming Peng, Qinglin Wang, Menghan Jia, Zhiquan Lai, Guangping Yu, Dongsheng Li, Tiejun Li, Jie Liu"
date: 2026-02-13
pdf: "https://arxiv.org/pdf/2602.13021v1"
tags: ["keyword:SR", "query:SR"]
score: 10.0
evidence: 先验引导的符号回归以确保科学一致性
tldr: 符号回归（SR）旨在从数据中发现可解释方程，但现有方法常陷入“伪方程陷阱”，即拟合度高但违背科学原理。本文提出PG-SR框架，通过预热、演化和精炼三阶段流程，引入先验约束检查器和先验退火约束评估（PACE）机制，将领域先验转化为可执行约束。理论证明该方法能降低假设空间复杂度并提高泛化能力，实验表明其在多领域优于现有基准，且对噪声和数据稀缺具有鲁棒性。
motivation: 现有符号回归方法过度依赖经验风险最小化，导致发现的方程虽然拟合数据但缺乏科学一致性，容易产生“伪方程”。
method: 提出PG-SR框架，利用先验约束检查器和先验退火约束评估机制，在三阶段演化过程中显式引入领域先验约束。
result: 实验证明PG-SR在多个领域均优于最先进的基准方法，并在数据噪声和稀缺情况下表现出极强的鲁棒性。
conclusion: 通过将科学先验融入符号回归过程，PG-SR有效解决了伪方程问题，实现了更具科学一致性的方程发现。
---

## 摘要
符号回归 (SR) 旨在从观测数据中发现可解释的方程，具有揭示自然现象背后潜在原理的潜力。然而，现有方法往往会陷入“伪方程陷阱”：生成的方程虽然能很好地拟合观测数据，但与基本科学原理不一致。一个关键原因是这些方法由经验风险最小化主导，缺乏确保科学一致性的显式约束。为了弥补这一差距，我们提出了 PG-SR，这是一个基于预热、进化和精炼三阶段流水线的先验引导符号回归框架。在整个流水线中，PG-SR 引入了一个先验约束检查器，将领域先验显式编码为可执行的约束程序，并在进化阶段采用先验退火约束评估 (PACE) 机制，逐步引导发现过程转向科学一致的区域。在理论上，我们证明了 PG-SR 降低了假设空间的 Rademacher 复杂度，从而产生了更紧致的泛化界限，并为防止伪方程提供了保证。在实验上，PG-SR 在多个领域均优于最先进的基准方法，并对不同的先验质量、噪声数据和数据稀缺性保持了鲁棒性。

## Abstract
Symbolic Regression (SR) aims to discover interpretable equations from observational data, with the potential to reveal underlying principles behind natural phenomena. However, existing approaches often fall into the Pseudo-Equation Trap: producing equations that fit observations well but remain inconsistent with fundamental scientific principles. A key reason is that these approaches are dominated by empirical risk minimization, lacking explicit constraints to ensure scientific consistency. To bridge this gap, we propose PG-SR, a prior-guided SR framework built upon a three-stage pipeline consisting of warm-up, evolution, and refinement. Throughout the pipeline, PG-SR introduces a prior constraint checker that explicitly encodes domain priors as executable constraint programs, and employs a Prior Annealing Constrained Evaluation (PACE) mechanism during the evolution stage to progressively steer discovery toward scientifically consistent regions. Theoretically, we prove that PG-SR reduces the Rademacher complexity of the hypothesis space, yielding tighter generalization bounds and establishing a guarantee against pseudo-equations. Experimentally, PG-SR outperforms state-of-the-art baselines across diverse domains, maintaining robustness to varying prior quality, noisy data, and data scarcity.

---

## 论文详细总结（自动生成）

这是一份关于论文《Prior-Guided Symbolic Regression: Towards Scientific Consistency in Equation Discovery》的结构化深入分析报告：

### 1. 核心问题与整体含义（研究动机和背景）
符号回归（SR）的核心目标是从观测数据中发现可解释的数学方程。然而，现有方法普遍面临**“伪方程陷阱”（Pseudo-Equation Trap）**：即模型为了追求极低的训练误差（经验风险最小化），生成了能够完美拟合噪声数据但在物理或科学逻辑上完全错误的方程。这种现象在数据稀缺或含有噪声时尤为严重，导致模型在分布外（OOD）预测时发生灾难性偏离。论文的研究动机在于：如何将显式的科学先验知识引入发现过程，确保方程不仅在数值上精确，且在科学原理上具有一致性。

### 2. 方法论：核心思想与技术细节
论文提出了 **PG-SR** 框架，其核心思想是将领域先验转化为可执行的约束程序，并通过三阶段流水线引导方程演化：

*   **先验约束检查器（Prior Constraint Checker）：** 利用 LLM 提取领域知识，结合人类专家的验证，将科学原理（如单峰响应、边界行为、单调性等）编写成 Python 约束检查程序。
*   **先验退火约束评估（PACE）机制：** 这是该方法的核心算法创新。为了避免早期搜索过于受限，PACE 采用类似模拟退火的策略：在演化初期允许违反约束以保持多样性，随着演化进行（时间 $t$ 增加），逐步加大对违反约束方程的惩罚，强制搜索空间收敛至科学一致的子空间。
*   **三阶段流水线：**
    1.  **预热（Warm-up）：** 基于数据统计特征生成初步的方程骨架，初始化经验池。
    2.  **演化（Evolution）：** 利用 LLM 作为算子，结合 PACE 评分从经验池中采样并生成新候选方程。
    3.  **精炼（Refinement）：** 引入残差分析和反思机制，针对拟合不佳的局部区域进行结构微调。
*   **理论保证：** 论文通过统计学习理论证明，引入先验约束能有效降低假设空间的 **Rademacher 复杂度**，从而获得更紧致的泛化界限。

### 3. 实验设计
*   **数据集/场景：** 涵盖了生物学（大肠杆菌生长动力学）、材料科学（铝合金应力-应变）、化学（反应动力学）和物理学（非线性振荡器）四个领域的 5 个复杂任务。
*   **基准方法（Baselines）：** 对比了 13 种最先进的方法，分为三类：
    *   **搜索类：** PySR, GPLearn, DSR, uDSR, Operon, GP-GOMEA。
    *   **Transformer 类：** TPSR, E2E, NeSymReS, PhyE2E。
    *   **LLM 类：** LLM-SR, LaSR, DrSR。
*   **评估指标：** 主要使用归一化均方误差（NMSE），重点关注分布内（ID）和分布外（OOD）的表现。

### 4. 资源与算力
*   **硬件环境：** 使用了 Intel Core i9-14900HX CPU 和单张 **NVIDIA GeForce RTX 4090 GPU**。
*   **推理成本：** 
    *   **时长：** 在标准基准（如振荡器任务）上，完整运行一次约需 **10 小时**。
    *   **API 消耗：** 每次运行约消耗 1785 万个 Token（以 GPT-4o-mini 为底座），折合商业 API 成本约 **4.70 美元**。
*   **模型底座：** 主要实验基于 GPT-4o-mini，同时也验证了 Llama-3.3-70B 的鲁棒性。

### 5. 实验数量与充分性
*   **实验规模：** 论文进行了多维度的详尽测试，包括 5 个数据集上的性能对比、针对 4 种不同先验质量（无先验、弱先验、错误先验、全先验）的敏感性分析、针对 3 种噪声水平的鲁棒性测试，以及从 5% 到 100% 数据可用性的稀缺性分析。
*   **消融实验：** 分别验证了预热、PACE 机制和精炼阶段的必要性。
*   **客观性：** 实验设计考虑了 OOD 泛化，这是衡量科学发现真实性的关键指标；同时对比了不同 LLM 底座，证明了框架的普适性而非依赖特定模型。

### 6. 主要结论与发现
*   **性能领先：** PG-SR 在所有数据集的 ID 和 OOD 测试中均取得了最低的 NMSE，显著优于现有的搜索类和 Transformer 类方法。
*   **解决伪方程：** 实验证明，显式先验约束能有效防止模型拟合噪声，使得发现的方程在物理趋势上与真值高度一致。
*   **鲁棒性极强：** 在数据极度稀缺（仅 5% 数据）或高噪声环境下，PG-SR 依然能保持稳定的预测性能，而基准方法大多发生溃败。
*   **先验容错性：** 即使引入错误的先验，得益于 PACE 机制，模型性能也不会低于无先验的基准水平，证明了系统的安全性。

### 7. 优点
*   **理论与实践结合：** 不仅有工程上的创新，还提供了 Rademacher 复杂度的理论证明，增强了方法的说服力。
*   **PACE 机制：** 巧妙地解决了“约束严苛性”与“搜索探索性”之间的矛盾。
*   **可解释性强：** 发现的方程（如振荡器任务）几乎完全还原了物理真值，具有极高的科学价值。
*   **端到端流程：** 提供了从知识提取到方程精炼的完整闭环。

### 8. 不足与局限
*   **人工干预：** 虽然利用了 LLM，但在构建“可执行先验约束程序”时仍需要一定程度的人类专家介入和验证，尚未实现完全的自动化。
*   **计算开销：** 相比于传统的遗传算法（如 PySR），基于 LLM 的迭代演化在时间和金钱成本上较高，不适合超大规模的快速筛选。
*   **先验依赖：** 尽管有容错机制，但该方法的上限高度依赖于所提供先验知识的质量和覆盖范围。

（完）
